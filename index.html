<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Todo App</title>
</head>
<body>
    <h1>Todo List</h1>

    <!-- Todo Form -->
    <h2>Add Todo</h2>
    <form id="todo-form">
        <label>ID: <input type="number" id="todo-id" required></label><br><br>
        <label>Name: <input type="text" id="todo-name" required></label><br><br>
        <label>Description: <input type="text" id="todo-desc" required></label><br><br>
        <button type="submit">Add Todo</button>
    </form>

    <h2>Todos</h2>
    <ul id="todo-list"></ul>

    <script>
        const list = document.getElementById('todo-list');
        const form = document.getElementById('todo-form');

        // Function to load todos
        function loadTodos() {
            list.innerHTML = ""; // Clear old list
            fetch('http://127.0.0.1:8000/get_todo')
                .then(response => response.json())
                .then(data => {
                    data.forEach(todo => {
                        const li = document.createElement('li');
                        li.textContent = `ID: ${todo.id}, Name: ${todo.name}, Description: ${todo.description}`;
                        list.appendChild(li);
                    });
                })
                .catch(error => {
                    console.error('Error fetching todos:', error);
                });
        }

        // Load todos when page loads
        loadTodos();

        // Handle form submit
        form.addEventListener('submit', function(e) {
            e.preventDefault();

            const todo = {
                id: document.getElementById('todo-id').value,
                name: document.getElementById('todo-name').value,
                description: document.getElementById('todo-desc').value
            };

            fetch('http://127.0.0.1:8000/append_todo', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(todo)
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                form.reset();  // Clear form
                loadTodos();   // Reload todos
            })
            .catch(error => {
                console.error('Error adding todo:', error);
            });
        });
    </script>
</body>
</html>
